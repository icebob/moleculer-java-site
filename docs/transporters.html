<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Transporters | Moleculer</title>
    <meta name="description" content="Progressive microservices framework for Java">
    
    
    <link rel="preload" href="/site/assets/css/0.styles.75e38820.css" as="style"><link rel="preload" href="/site/assets/js/app.9acef152.js" as="script"><link rel="preload" href="/site/assets/js/2.ee67e98b.js" as="script"><link rel="preload" href="/site/assets/js/26.2c732a20.js" as="script"><link rel="prefetch" href="/site/assets/js/10.0c51408a.js"><link rel="prefetch" href="/site/assets/js/11.35085d4f.js"><link rel="prefetch" href="/site/assets/js/12.b8887cbf.js"><link rel="prefetch" href="/site/assets/js/13.e6912905.js"><link rel="prefetch" href="/site/assets/js/14.f89c1874.js"><link rel="prefetch" href="/site/assets/js/15.96da9083.js"><link rel="prefetch" href="/site/assets/js/16.64b959d6.js"><link rel="prefetch" href="/site/assets/js/17.00bde7ec.js"><link rel="prefetch" href="/site/assets/js/18.226004fa.js"><link rel="prefetch" href="/site/assets/js/19.ae18779b.js"><link rel="prefetch" href="/site/assets/js/20.ef5ec2cf.js"><link rel="prefetch" href="/site/assets/js/21.3e703e8e.js"><link rel="prefetch" href="/site/assets/js/22.9497ca52.js"><link rel="prefetch" href="/site/assets/js/23.62b579e2.js"><link rel="prefetch" href="/site/assets/js/24.b704a915.js"><link rel="prefetch" href="/site/assets/js/25.8ed0f3cc.js"><link rel="prefetch" href="/site/assets/js/27.d61b2d89.js"><link rel="prefetch" href="/site/assets/js/3.f084eaa4.js"><link rel="prefetch" href="/site/assets/js/4.a02ade56.js"><link rel="prefetch" href="/site/assets/js/5.357c372d.js"><link rel="prefetch" href="/site/assets/js/6.ce997fe8.js"><link rel="prefetch" href="/site/assets/js/7.d678ff04.js"><link rel="prefetch" href="/site/assets/js/8.67823e67.js"><link rel="prefetch" href="/site/assets/js/9.dfda2b92.js">
    <link rel="stylesheet" href="/site/assets/css/0.styles.75e38820.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/site/" class="home-link router-link-active"><!----> <span class="site-name">Moleculer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/site/" class="nav-link">Home</a></div><div class="nav-item"><a href="/site/introduction.html" class="nav-link">Documentation</a></div><div class="nav-item"><a href="https://github.com/moleculer-java/moleculer-java" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/site/" class="nav-link">Home</a></div><div class="nav-item"><a href="/site/introduction.html" class="nav-link">Documentation</a></div><div class="nav-item"><a href="https://github.com/moleculer-java/moleculer-java" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Clustering</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/site/transporters.html" class="active sidebar-link">Transporters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/site/transporters.html#centralized-transporters" class="sidebar-link">Centralized Transporters</a></li><li class="sidebar-sub-header"><a href="/site/transporters.html#decentralized-peer-to-peer-transporters" class="sidebar-link">Decentralized, Peer-to-Peer Transporters</a></li><li class="sidebar-sub-header"><a href="/site/transporters.html#custom-transporter" class="sidebar-link">Custom Transporter</a></li></ul></li><li><a href="/site/serializers.html" class="sidebar-link">Serializers</a></li><li><a href="/site/balancing.html" class="sidebar-link">Load Balancing</a></li><li><a href="/site/fault-tolerance.html" class="sidebar-link">Fault Tolerance</a></li><li><a href="/site/logging.html" class="sidebar-link">Logging</a></li><li><a href="/site/runner.html" class="sidebar-link">Runner</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Modules</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>In order to communicate with other nodes (ServiceBroker instances) you need to configure a Transporter.<br>
There are two types of Transporter:</p> <ul><li><p><strong>Centralized</strong> Transporters: Transporters using a central server. The central server can be, for example, a Redis, NATS, Kafka, MQTT or a JMS server.</p></li> <li><p><strong>Decentralized</strong>, Peer-to-Peer Transporters: Transporters without a central server. For example, TCPTransporter belongs to this group, which uses Gossip protocol to publish the status of the nodes.</p></li></ul> <p>Transporter communicates with other nodes, transfers events, calls requests and processes responses.
If a service runs on multiple instances on different nodes, the requests will be load-balanced among live nodes.
Each Transporter can be assigned a Serializer. Serializers convert messages into bytes and vice versa.
There are several built-in Transporters in Moleculer Framework.</p> <h2 id="centralized-transporters"><a href="#centralized-transporters" class="header-anchor">#</a> Centralized Transporters</h2> <p>Centralized Transporters connect to a central message broker that provide a reliable way of exchanging messages among remote nodes.
These brokers use publish/subscribe messaging pattern to deliver data packets.</p> <div align="center"><img src="assets/networking.svg" alt="Networking diagram"></div> <h3 id="nats-transporter"><a href="#nats-transporter" class="header-anchor">#</a> NATS Transporter</h3> <p>Built-in transporter for <a href="http://nats.io/" target="_blank" rel="noopener noreferrer">NATS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
NATS Server is a simple, high performance open source messaging system for cloud native applications,
IoT messaging, and microservices architectures.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">NatsTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NatsTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;nats://nats.server:4222&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use NATS Transporter, add the following dependency to the build script:<br>
group: 'io.nats', name: 'jnats', version: '2.6.5'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Create Transporter</span>
<span class="token class-name">NatsTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NatsTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;host1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Configure Transporter</span>
transporter<span class="token punctuation">.</span><span class="token function">setSecure</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setNoRandomize</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create Service Broker</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Install distributed Services</span>
broker<span class="token punctuation">.</span><span class="token function">createService</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Service</span><span class="token punctuation">(</span><span class="token string">&quot;testService&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Action</span> testAction <span class="token operator">=</span> ctx <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>

        <span class="token comment">// Process request JSON (ctx.params),</span>
        <span class="token comment">// and create response JSON structure</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
<span class="token comment">// Connect the Service Broker to other Nodes</span>
broker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="redis-transporter"><a href="#redis-transporter" class="header-anchor">#</a> Redis Transporter</h3> <p>Built-in Transporter for <a href="http://redis.io/" target="_blank" rel="noopener noreferrer">Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">RedisTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;redis://redis.server:6379&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use Redis Transporter, add the following dependency to the build script:<br>
group: 'biz.paluch.redis', name: 'lettuce', version: '4.5.0.Final'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">RedisTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;host1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setSecure</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mqtt-transporter"><a href="#mqtt-transporter" class="header-anchor">#</a> MQTT Transporter</h3> <p>Built-in Transporter for <a href="http://mqtt.org/" target="_blank" rel="noopener noreferrer">MQTT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> protocol.
MQTT Transporter (eg. for <a href="https://mosquitto.org/" target="_blank" rel="noopener noreferrer">Mosquitto<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> MQTT Server or ActiveMQ Server).
MQTT is a machine-to-machine (M2M)/&quot;Internet of Things&quot; connectivity protocol.
It was designed as an extremely lightweight publish/subscribe messaging transport.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">MqttTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;mqtt://mqtt-server:1883&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use MQTT Transporter, add the following dependency to the build script:<br>
group: 'net.sf.xenqtt', name: 'xenqtt', version: '0.9.7'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">MqttTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;host1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setKeepAliveSeconds</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setConnectTimeoutSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setMessageResendIntervalSeconds</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="amqp-transporter"><a href="#amqp-transporter" class="header-anchor">#</a> AMQP Transporter</h3> <p>Built-in Transporter for <a href="https://www.amqp.org/" target="_blank" rel="noopener noreferrer">AMQP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> protocol.
AMQP Transporter based on <a href="https://www.rabbitmq.com/" target="_blank" rel="noopener noreferrer">RabbitMQ's<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> AMQP client API.
AMQP provides a platform-agnostic method for ensuring information is safely transported
between applications, among organizations, within mobile infrastructures, and across the Cloud.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">AmqpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AmqpTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;amqp://rabbitmq-server:5672&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use AMQP Transporter, add the following dependency to the build script:<br>
group: 'com.rabbitmq', name: 'amqp-client', version: '5.7.3'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">AmqpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AmqpTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;host1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setSslContextFactory</span><span class="token punctuation">(</span>customSslFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setQueueProperties</span><span class="token punctuation">(</span>customQueueProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setExchangeProperties</span><span class="token punctuation">(</span>customExchangeProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="kafka-transporter"><a href="#kafka-transporter" class="header-anchor">#</a> Kafka Transporter</h3> <p>Built-in Transporter for <a href="https://kafka.apache.org/" target="_blank" rel="noopener noreferrer">Kafka<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
Kafka is used for building real-time data pipelines and streaming apps.
It is horizontally scalable, fault-tolerant, wicked fast, and runs in production in thousands of companies.
Kafka Transporter is a very simple implementation.
It transfers Moleculer packets to consumers via pub/sub.
There are not implemented offset, replay, etc. features.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">KafkaTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;kafka://server:9092&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use Kafka Transporter, add the following dependency to the build script:<br>
group: 'org.apache.kafka', name: 'kafka-clients', version: '2.3.0'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">KafkaTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setUrls</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;192.168.51.29:9092&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setProducerProperty</span><span class="token punctuation">(</span><span class="token string">&quot;session.timeout.ms&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="jms-transporter"><a href="#jms-transporter" class="header-anchor">#</a> JMS Transporter</h3> <p>Built-in Transporter for <a href="https://www.oracle.com/technical-resources/articles/java/intro-java-message-service.html" target="_blank" rel="noopener noreferrer">Java Message Service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
The Java Message Service API is a Java Message Oriented Middleware API for sending messages between two or more clients.
It is an implementation to handle the Producer-consumer problem.
JMS is a part of the Java Enterprise Edition.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Sample of usage with Active MQ</span>
<span class="token class-name">JmsTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JmsTransporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use JMS Transporter, add the following dependency to the build script:<br>
group: 'javax.jms', name: 'javax.jms-api', version: '2.0.1'</p> <ul><li>dependencies of the JMS driver.
:::</li></ul> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">JmsTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JmsTransporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;secret&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setAcknowledgeMode</span><span class="token punctuation">(</span><span class="token class-name">JMSContext</span><span class="token punctuation">.</span>AUTO_ACKNOWLEDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setDeliveryMode</span><span class="token punctuation">(</span><span class="token class-name">DeliveryMode</span><span class="token punctuation">.</span>NON_PERSISTENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setTransacted</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setTtl</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="google-pub-sub-transporter"><a href="#google-pub-sub-transporter" class="header-anchor">#</a> Google Pub/Sub Transporter</h3> <p>Built-in Transporter for <a href="https://cloud.google.com/pubsub/docs/overview" target="_blank" rel="noopener noreferrer">Google Cloud Pub/Sub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
The Google Cloud Pub/Sub service allows applications to exchange messages reliably, quickly, and asynchronously.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">GoogleTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoogleTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;/credentials.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>::: details Dependencies
To use Google Pub/Sub Transporter, add the following dependency to the build script:<br>
group: 'com.google.cloud', name: 'google-cloud-pubsub', version: '1.96.0'
:::</p> <p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">GoogleTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoogleTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;/credentials.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setProjectID</span><span class="token punctuation">(</span><span class="token string">&quot;Project-123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setBatchingSettings</span><span class="token punctuation">(</span>customBatchSettings<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setCredentialsProvider</span><span class="token punctuation">(</span>customCredentialsProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
transporter<span class="token punctuation">.</span><span class="token function">setRetrySettings</span><span class="token punctuation">(</span>customRetrySettings<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="decentralized-peer-to-peer-transporters"><a href="#decentralized-peer-to-peer-transporters" class="header-anchor">#</a> Decentralized, Peer-to-Peer Transporters</h2> <h3 id="tcp-transporter"><a href="#tcp-transporter" class="header-anchor">#</a> TCP Transporter</h3> <p>TCP Transporter uses fault tolerant and peer-to-peer
<a href="https://en.wikipedia.org/wiki/Gossip_protocol" target="_blank" rel="noopener noreferrer">Gossip protocol<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
to discover location and service information about the other nodes
participating in a Moleculer Cluster. In Moleculer's P2P architecture all
nodes are equal, there is no &quot;leader&quot; or &quot;controller&quot; node, so the cluster is
truly horizontally scalable. This Transporter aims to run on top of an
infrastructure of hundreds of nodes.</p> <p>It contains an integrated UDP discovery feature to detect new and disconnected nodes on the network.
If the UDP is prohibited on your network, use <code>urls</code> option.
It is a list of remote endpoints (host/ip, port, nodeID).
It can be a static list in your configuration or a file path which contains the list.
TCP Transporter provides the highest speed data transfer between Moleculer
Nodes - hundred thousand packets per second can be transmitted from one node to another over a high-speed LAN.</p> <p>Use TCP Transporter with default options:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Create Transporter</span>
<span class="token class-name">TcpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TcpTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create Service Broker</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
<span class="token comment">// Install distributed Services</span>
broker<span class="token punctuation">.</span><span class="token function">createService</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Service</span><span class="token punctuation">(</span><span class="token string">&quot;testService&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Action</span> testAction <span class="token operator">=</span> ctx <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>

        <span class="token comment">// Process request JSON (ctx.params),</span>
        <span class="token comment">// and create response JSON structure</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
<span class="token comment">// Connect the Service Broker to other Nodes</span>
broker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Detailed example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">TcpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TcpTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// TCP port (used by the Transporter and Gossiper services).</span>
<span class="token comment">// A port number of zero will let the system pick up an ephemeral port in a bind operation.</span>
transporter<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Gossiping period time, in SECONDS.</span>
transporter<span class="token punctuation">.</span><span class="token function">setGossipPeriod</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Max number of keep-alive connections (-1 = unlimited, 0 = disable keep-alive connections).</span>
transporter<span class="token punctuation">.</span><span class="token function">setMaxConnections</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Max enable packet size (BYTES).</span>
transporter<span class="token punctuation">.</span><span class="token function">setMaxPacketSize</span><span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// List of URLs (&quot;tcp://host:port/nodeID&quot; or &quot;host:port/nodeID&quot;</span>
<span class="token comment">// or &quot;host/nodeID&quot;), when UDP discovery is disabled.</span>
transporter<span class="token punctuation">.</span><span class="token function">setUrls</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use hostnames instead of IP addresses As the DHCP environment is dynamic,</span>
<span class="token comment">// any later attempt to use IPs instead hostnames would most likely yield</span>
<span class="token comment">// false results. Therefore, use hostnames if you are using DHCP.</span>
transporter<span class="token punctuation">.</span><span class="token function">setUseHostname</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// UDP broadcast/multicast port</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpPort</span><span class="token punctuation">(</span><span class="token number">4445</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// UDP bind address (null = autodetect)</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpBindAddress</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// UDP broadcast/multicast period in SECONDS</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpPeriod</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Resuse addresses</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpReuseAddr</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Maximum number of outgoing multicast packets (0 = runs forever)</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpMaxDiscovery</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// UDP multicast address of automatic discovery service.</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpMulticast</span><span class="token punctuation">(</span><span class="token string">&quot;239.0.0.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// TTL of UDP multicast packets</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpMulticastTTL</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use UDP broadcast WITH UDP multicast (false = use UDP multicast only)</span>
transporter<span class="token punctuation">.</span><span class="token function">setUdpBroadcast</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>TCP Transporter with static endpoint list:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">TcpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TcpTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;172.17.0.1:6000/node-1&quot;</span><span class="token punctuation">,</span>
                                                <span class="token string">&quot;172.17.0.2:6000/node-2&quot;</span><span class="token punctuation">,</span>
                                                <span class="token string">&quot;172.17.0.3:6000/node-3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><em>You don't need to set <code>port</code> because it find &amp; parse the self TCP port from URL list.</em></p> <p>TCP Transporter with static endpoint list file:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">TcpTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TcpTransporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;file:///nodes.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// nodes.json</span>
<span class="token punctuation">[</span>
    <span class="token string">&quot;127.0.0.1:6001/client-1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;127.0.0.1:7001/server-1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;127.0.0.1:7002/server-2&quot;</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Serviceless node</p> <p>Please note, you don't need to list all remote nodes.
It's enough at least one online node.
For example, create a &quot;serviceless&quot; gossiper node, which does nothing,
just shares other remote nodes addresses by gossip messages.
So all nodes must know only the gossiper node address to be able to communicate with all other nodes.</p></div> <h3 id="internal-transporter"><a href="#internal-transporter" class="header-anchor">#</a> Internal Transporter</h3> <p>Internal Transporter is a built-in message bus that can connect multiple ServiceBrokers running in the same JVM.
This Transporter is primarily used for testing purposes.
The calls are made in separate Threads, so call timeouts can be used.</p> <p>Using the shared (static) communication group:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ServiceBroker</span> broker1 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node1&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker2 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node2&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Using independent communication groups:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// --- CREATE COMMUNICATION GROUPS ---</span>

<span class="token class-name">Subscriptions</span> group1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Subscriptions</span> group2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// --- CREATE TRANSPORTERS ---</span>

<span class="token comment">// Group-1</span>
<span class="token class-name">InternalTransporter</span> transporter1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span>group1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InternalTransporter</span> transporter2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span>group1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Group-2</span>
<span class="token class-name">InternalTransporter</span> transporter3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span>group2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InternalTransporter</span> transporter4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalTransporter</span><span class="token punctuation">(</span>group2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// --- CREATE SERVICE BROKERS ---</span>

<span class="token comment">// Group-1</span>
<span class="token class-name">ServiceBroker</span> broker1 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node1&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter1<span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker2 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node2&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter2<span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Group-2</span>
<span class="token class-name">ServiceBroker</span> broker3 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node3&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter3<span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker4 <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;node4&quot;</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter4<span class="token punctuation">)</span>
                                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="file-system-transporter"><a href="#file-system-transporter" class="header-anchor">#</a> File System Transporter</h3> <p>Built-in, filesystem-based, server-less Transporter.
With this Transporter multiple Service Brokers can communicate with each other through a shared directory structure.
File System Transporter is not advisable for use in production mode as it is much slower than other Transporter.
Rather it can be considered as a reference implementation or a code sample.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">FileSystemTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemTransporter</span><span class="token punctuation">(</span><span class="token string">&quot;/shared/dir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="udp-multicast-transporter"><a href="#udp-multicast-transporter" class="header-anchor">#</a> UDP Multicast Transporter</h3> <p>Built-in, multicast UDP-based, server-less transporter.
This is another Transporter implementation example.
UDP Multicast Transporter is not for production use;
UDP communication is lossy, and the packet size is limited.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">UdpMulticastTransporter</span> transporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UdpMulticastTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span>transporter<span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="custom-transporter"><a href="#custom-transporter" class="header-anchor">#</a> Custom Transporter</h2> <p>Custom Transporter module can be created.
The simplest solution is to copy the source code of an existing Transporter
and modify the <code>connect</code>, <code>stopped</code>, <code>subscribe</code> and <code>publish</code> methods.</p> <p>Create custom Transporter:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomTransporter</span> <span class="token keyword">extends</span> <span class="token class-name">Transporter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> connect <span class="token punctuation">{</span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">publish</span><span class="token punctuation">(</span><span class="token class-name">String</span> channel<span class="token punctuation">,</span> <span class="token class-name">Tree</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Promise</span> <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">String</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Use custom Transporter:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ServiceBroker</span> broker <span class="token operator">=</span> <span class="token class-name">ServiceBroker</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">nodeID</span><span class="token punctuation">(</span><span class="token string">&quot;server-1&quot;</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">transporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CustomTransporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/site/internal-services.html" class="prev">Internal Services</a></span> <span class="next"><a href="/site/serializers.html">Serializers</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/site/assets/js/app.9acef152.js" defer></script><script src="/site/assets/js/2.ee67e98b.js" defer></script><script src="/site/assets/js/26.2c732a20.js" defer></script>
  </body>
</html>
